#nullable enable
using Neatoo.RemoteFactory;
using Neatoo.RemoteFactory.Internal;
using Microsoft.Extensions.DependencyInjection;

/*
    READONLY - DO NOT EDIT!!!!
    Generated by Neatoo.RemoteFactory
*/
namespace RemoteFactory.IntegrationTests.TestTargets.TypeSerialization
{
    public interface IInterfaceCollectionContainerFactory
    {
        Task<InterfaceCollectionContainer> Create(CancellationToken cancellationToken = default);
        Task<InterfaceCollectionContainer> FetchWithAllCollectionTypes(CancellationToken cancellationToken = default);
        Task<InterfaceCollectionContainer> FetchSingleInterface(CancellationToken cancellationToken = default);
        Task<InterfaceCollectionContainer> FetchListOfInterface(CancellationToken cancellationToken = default);
        Task<InterfaceCollectionContainer> FetchIListOfInterface(CancellationToken cancellationToken = default);
        Task<InterfaceCollectionContainer> FetchICollectionOfInterface(CancellationToken cancellationToken = default);
        Task<InterfaceCollectionContainer> FetchNestedParent(CancellationToken cancellationToken = default);
        Task<InterfaceCollectionContainer?> Save(InterfaceCollectionContainer target, CancellationToken cancellationToken = default);
    }

    internal class InterfaceCollectionContainerFactory : FactorySaveBase<InterfaceCollectionContainer>, IFactorySave<InterfaceCollectionContainer>, IInterfaceCollectionContainerFactory
    {
        private readonly IServiceProvider ServiceProvider;
        private readonly IMakeRemoteDelegateRequest? MakeRemoteDelegateRequest;
        // Delegates
        public delegate Task<InterfaceCollectionContainer> CreateDelegate(CancellationToken cancellationToken = default);
        public delegate Task<InterfaceCollectionContainer> FetchWithAllCollectionTypesDelegate(CancellationToken cancellationToken = default);
        public delegate Task<InterfaceCollectionContainer> FetchSingleInterfaceDelegate(CancellationToken cancellationToken = default);
        public delegate Task<InterfaceCollectionContainer> FetchListOfInterfaceDelegate(CancellationToken cancellationToken = default);
        public delegate Task<InterfaceCollectionContainer> FetchIListOfInterfaceDelegate(CancellationToken cancellationToken = default);
        public delegate Task<InterfaceCollectionContainer> FetchICollectionOfInterfaceDelegate(CancellationToken cancellationToken = default);
        public delegate Task<InterfaceCollectionContainer> FetchNestedParentDelegate(CancellationToken cancellationToken = default);
        public delegate Task<InterfaceCollectionContainer?> SaveDelegate(InterfaceCollectionContainer target, CancellationToken cancellationToken = default);
        // Delegate Properties to provide Local or Remote fork in execution
        public CreateDelegate CreateProperty { get; }
        public FetchWithAllCollectionTypesDelegate FetchWithAllCollectionTypesProperty { get; }
        public FetchSingleInterfaceDelegate FetchSingleInterfaceProperty { get; }
        public FetchListOfInterfaceDelegate FetchListOfInterfaceProperty { get; }
        public FetchIListOfInterfaceDelegate FetchIListOfInterfaceProperty { get; }
        public FetchICollectionOfInterfaceDelegate FetchICollectionOfInterfaceProperty { get; }
        public FetchNestedParentDelegate FetchNestedParentProperty { get; }
        public SaveDelegate SaveProperty { get; }

        public InterfaceCollectionContainerFactory(IServiceProvider serviceProvider, IFactoryCore<InterfaceCollectionContainer> factoryCore) : base(factoryCore)
        {
            this.ServiceProvider = serviceProvider;
            CreateProperty = LocalCreate;
            FetchWithAllCollectionTypesProperty = LocalFetchWithAllCollectionTypes;
            FetchSingleInterfaceProperty = LocalFetchSingleInterface;
            FetchListOfInterfaceProperty = LocalFetchListOfInterface;
            FetchIListOfInterfaceProperty = LocalFetchIListOfInterface;
            FetchICollectionOfInterfaceProperty = LocalFetchICollectionOfInterface;
            FetchNestedParentProperty = LocalFetchNestedParent;
            SaveProperty = LocalSave;
        }

        public InterfaceCollectionContainerFactory(IServiceProvider serviceProvider, IMakeRemoteDelegateRequest remoteMethodDelegate, IFactoryCore<InterfaceCollectionContainer> factoryCore) : base(factoryCore)
        {
            this.ServiceProvider = serviceProvider;
            this.MakeRemoteDelegateRequest = remoteMethodDelegate;
            CreateProperty = RemoteCreate;
            FetchWithAllCollectionTypesProperty = RemoteFetchWithAllCollectionTypes;
            FetchSingleInterfaceProperty = RemoteFetchSingleInterface;
            FetchListOfInterfaceProperty = RemoteFetchListOfInterface;
            FetchIListOfInterfaceProperty = RemoteFetchIListOfInterface;
            FetchICollectionOfInterfaceProperty = RemoteFetchICollectionOfInterface;
            FetchNestedParentProperty = RemoteFetchNestedParent;
            SaveProperty = RemoteSave;
        }

        public virtual Task<InterfaceCollectionContainer> Create(CancellationToken cancellationToken = default)
        {
            return CreateProperty(cancellationToken);
        }

        public virtual async Task<InterfaceCollectionContainer> RemoteCreate(CancellationToken cancellationToken = default)
        {
            return (await MakeRemoteDelegateRequest!.ForDelegate<InterfaceCollectionContainer>(typeof(CreateDelegate), [], cancellationToken))!;
        }

        public Task<InterfaceCollectionContainer> LocalCreate(CancellationToken cancellationToken = default)
        {
            return Task.FromResult(DoFactoryMethodCall(FactoryOperation.Create, () => InterfaceCollectionContainer.Create()));
        }

        public virtual Task<InterfaceCollectionContainer> FetchWithAllCollectionTypes(CancellationToken cancellationToken = default)
        {
            return FetchWithAllCollectionTypesProperty(cancellationToken);
        }

        public virtual async Task<InterfaceCollectionContainer> RemoteFetchWithAllCollectionTypes(CancellationToken cancellationToken = default)
        {
            return (await MakeRemoteDelegateRequest!.ForDelegate<InterfaceCollectionContainer>(typeof(FetchWithAllCollectionTypesDelegate), [], cancellationToken))!;
        }

        public Task<InterfaceCollectionContainer> LocalFetchWithAllCollectionTypes(CancellationToken cancellationToken = default)
        {
            var childFactory = ServiceProvider.GetRequiredService<ITestChildImplFactory>();
            var parentFactory = ServiceProvider.GetRequiredService<ITestParentImplFactory>();
            return Task.FromResult(DoFactoryMethodCall(FactoryOperation.Fetch, () => InterfaceCollectionContainer.FetchWithAllCollectionTypes(childFactory, parentFactory)));
        }

        public virtual Task<InterfaceCollectionContainer> FetchSingleInterface(CancellationToken cancellationToken = default)
        {
            return FetchSingleInterfaceProperty(cancellationToken);
        }

        public virtual async Task<InterfaceCollectionContainer> RemoteFetchSingleInterface(CancellationToken cancellationToken = default)
        {
            return (await MakeRemoteDelegateRequest!.ForDelegate<InterfaceCollectionContainer>(typeof(FetchSingleInterfaceDelegate), [], cancellationToken))!;
        }

        public Task<InterfaceCollectionContainer> LocalFetchSingleInterface(CancellationToken cancellationToken = default)
        {
            var childFactory = ServiceProvider.GetRequiredService<ITestChildImplFactory>();
            return Task.FromResult(DoFactoryMethodCall(FactoryOperation.Fetch, () => InterfaceCollectionContainer.FetchSingleInterface(childFactory)));
        }

        public virtual Task<InterfaceCollectionContainer> FetchListOfInterface(CancellationToken cancellationToken = default)
        {
            return FetchListOfInterfaceProperty(cancellationToken);
        }

        public virtual async Task<InterfaceCollectionContainer> RemoteFetchListOfInterface(CancellationToken cancellationToken = default)
        {
            return (await MakeRemoteDelegateRequest!.ForDelegate<InterfaceCollectionContainer>(typeof(FetchListOfInterfaceDelegate), [], cancellationToken))!;
        }

        public Task<InterfaceCollectionContainer> LocalFetchListOfInterface(CancellationToken cancellationToken = default)
        {
            var childFactory = ServiceProvider.GetRequiredService<ITestChildImplFactory>();
            return Task.FromResult(DoFactoryMethodCall(FactoryOperation.Fetch, () => InterfaceCollectionContainer.FetchListOfInterface(childFactory)));
        }

        public virtual Task<InterfaceCollectionContainer> FetchIListOfInterface(CancellationToken cancellationToken = default)
        {
            return FetchIListOfInterfaceProperty(cancellationToken);
        }

        public virtual async Task<InterfaceCollectionContainer> RemoteFetchIListOfInterface(CancellationToken cancellationToken = default)
        {
            return (await MakeRemoteDelegateRequest!.ForDelegate<InterfaceCollectionContainer>(typeof(FetchIListOfInterfaceDelegate), [], cancellationToken))!;
        }

        public Task<InterfaceCollectionContainer> LocalFetchIListOfInterface(CancellationToken cancellationToken = default)
        {
            var childFactory = ServiceProvider.GetRequiredService<ITestChildImplFactory>();
            return Task.FromResult(DoFactoryMethodCall(FactoryOperation.Fetch, () => InterfaceCollectionContainer.FetchIListOfInterface(childFactory)));
        }

        public virtual Task<InterfaceCollectionContainer> FetchICollectionOfInterface(CancellationToken cancellationToken = default)
        {
            return FetchICollectionOfInterfaceProperty(cancellationToken);
        }

        public virtual async Task<InterfaceCollectionContainer> RemoteFetchICollectionOfInterface(CancellationToken cancellationToken = default)
        {
            return (await MakeRemoteDelegateRequest!.ForDelegate<InterfaceCollectionContainer>(typeof(FetchICollectionOfInterfaceDelegate), [], cancellationToken))!;
        }

        public Task<InterfaceCollectionContainer> LocalFetchICollectionOfInterface(CancellationToken cancellationToken = default)
        {
            var childFactory = ServiceProvider.GetRequiredService<ITestChildImplFactory>();
            return Task.FromResult(DoFactoryMethodCall(FactoryOperation.Fetch, () => InterfaceCollectionContainer.FetchICollectionOfInterface(childFactory)));
        }

        public virtual Task<InterfaceCollectionContainer> FetchNestedParent(CancellationToken cancellationToken = default)
        {
            return FetchNestedParentProperty(cancellationToken);
        }

        public virtual async Task<InterfaceCollectionContainer> RemoteFetchNestedParent(CancellationToken cancellationToken = default)
        {
            return (await MakeRemoteDelegateRequest!.ForDelegate<InterfaceCollectionContainer>(typeof(FetchNestedParentDelegate), [], cancellationToken))!;
        }

        public Task<InterfaceCollectionContainer> LocalFetchNestedParent(CancellationToken cancellationToken = default)
        {
            var parentFactory = ServiceProvider.GetRequiredService<ITestParentImplFactory>();
            return Task.FromResult(DoFactoryMethodCall(FactoryOperation.Fetch, () => InterfaceCollectionContainer.FetchNestedParent(parentFactory)));
        }

        public Task<InterfaceCollectionContainer> LocalInsert(InterfaceCollectionContainer target, CancellationToken cancellationToken = default)
        {
            var cTarget = (InterfaceCollectionContainer)target ?? throw new Exception("InterfaceCollectionContainer must implement InterfaceCollectionContainer");
            return DoFactoryMethodCallAsync(cTarget, FactoryOperation.Insert, () => cTarget.Insert());
        }

        public Task<InterfaceCollectionContainer> LocalUpdate(InterfaceCollectionContainer target, CancellationToken cancellationToken = default)
        {
            var cTarget = (InterfaceCollectionContainer)target ?? throw new Exception("InterfaceCollectionContainer must implement InterfaceCollectionContainer");
            return DoFactoryMethodCallAsync(cTarget, FactoryOperation.Update, () => cTarget.Update());
        }

        public Task<InterfaceCollectionContainer> LocalDelete(InterfaceCollectionContainer target, CancellationToken cancellationToken = default)
        {
            var cTarget = (InterfaceCollectionContainer)target ?? throw new Exception("InterfaceCollectionContainer must implement InterfaceCollectionContainer");
            return DoFactoryMethodCallAsync(cTarget, FactoryOperation.Delete, () => cTarget.Delete());
        }

        public virtual Task<InterfaceCollectionContainer?> Save(InterfaceCollectionContainer target, CancellationToken cancellationToken = default)
        {
            return SaveProperty(target, cancellationToken);
        }

        public virtual async Task<InterfaceCollectionContainer?> RemoteSave(InterfaceCollectionContainer target, CancellationToken cancellationToken = default)
        {
            return (await MakeRemoteDelegateRequest!.ForDelegateNullable<InterfaceCollectionContainer?>(typeof(SaveDelegate), [target], cancellationToken))!;
        }

        public virtual Task<InterfaceCollectionContainer?> LocalSave(InterfaceCollectionContainer target, CancellationToken cancellationToken = default)
        {
            if (target.IsDeleted)
            {
                if (target.IsNew)
                {
                    return Task.FromResult(default(InterfaceCollectionContainer));
                }

                return (LocalDelete(target, cancellationToken))!;
            }
            else if (target.IsNew)
            {
                return (LocalInsert(target, cancellationToken))!;
            }
            else
            {
                return (LocalUpdate(target, cancellationToken))!;
            }
        }

        async Task<IFactorySaveMeta?> IFactorySave<InterfaceCollectionContainer>.Save(InterfaceCollectionContainer target, CancellationToken cancellationToken)
        {
            return (IFactorySaveMeta? )await Save(target, cancellationToken);
        }

        public static void FactoryServiceRegistrar(IServiceCollection services, NeatooFactory remoteLocal)
        {
            services.AddScoped<InterfaceCollectionContainerFactory>();
            services.AddScoped<IInterfaceCollectionContainerFactory, InterfaceCollectionContainerFactory>();
            services.AddScoped<IFactorySave<InterfaceCollectionContainer>, InterfaceCollectionContainerFactory>();
            services.AddScoped<CreateDelegate>(cc =>
            {
                var factory = cc.GetRequiredService<InterfaceCollectionContainerFactory>();
                return (CancellationToken cancellationToken = default) => factory.LocalCreate(cancellationToken);
            });
            services.AddScoped<FetchWithAllCollectionTypesDelegate>(cc =>
            {
                var factory = cc.GetRequiredService<InterfaceCollectionContainerFactory>();
                return (CancellationToken cancellationToken = default) => factory.LocalFetchWithAllCollectionTypes(cancellationToken);
            });
            services.AddScoped<FetchSingleInterfaceDelegate>(cc =>
            {
                var factory = cc.GetRequiredService<InterfaceCollectionContainerFactory>();
                return (CancellationToken cancellationToken = default) => factory.LocalFetchSingleInterface(cancellationToken);
            });
            services.AddScoped<FetchListOfInterfaceDelegate>(cc =>
            {
                var factory = cc.GetRequiredService<InterfaceCollectionContainerFactory>();
                return (CancellationToken cancellationToken = default) => factory.LocalFetchListOfInterface(cancellationToken);
            });
            services.AddScoped<FetchIListOfInterfaceDelegate>(cc =>
            {
                var factory = cc.GetRequiredService<InterfaceCollectionContainerFactory>();
                return (CancellationToken cancellationToken = default) => factory.LocalFetchIListOfInterface(cancellationToken);
            });
            services.AddScoped<FetchICollectionOfInterfaceDelegate>(cc =>
            {
                var factory = cc.GetRequiredService<InterfaceCollectionContainerFactory>();
                return (CancellationToken cancellationToken = default) => factory.LocalFetchICollectionOfInterface(cancellationToken);
            });
            services.AddScoped<FetchNestedParentDelegate>(cc =>
            {
                var factory = cc.GetRequiredService<InterfaceCollectionContainerFactory>();
                return (CancellationToken cancellationToken = default) => factory.LocalFetchNestedParent(cancellationToken);
            });
            services.AddScoped<SaveDelegate>(cc =>
            {
                var factory = cc.GetRequiredService<InterfaceCollectionContainerFactory>();
                return (InterfaceCollectionContainer target, CancellationToken cancellationToken = default) => factory.LocalSave(target, cancellationToken);
            });
            // Event registrations
            if (remoteLocal == NeatooFactory.Remote)
            {
            }

            if (remoteLocal == NeatooFactory.Logical || remoteLocal == NeatooFactory.Server)
            {
            }
        }
    }
}