#nullable enable
using Neatoo.RemoteFactory;
using Neatoo.RemoteFactory.Internal;
using Microsoft.Extensions.DependencyInjection;
using RemoteFactory.IntegrationTests.Shared;

/*
    READONLY - DO NOT EDIT!!!!
    Generated by Neatoo.RemoteFactory
*/
namespace RemoteFactory.IntegrationTests.TestTargets.Parameters
{
    public interface IMultiServiceRemoteWriteTargetFactory
    {
        MultiServiceRemoteWriteTarget Create(CancellationToken cancellationToken = default);
        Task<MultiServiceRemoteWriteTarget?> SaveRemoteWithTwoServices(MultiServiceRemoteWriteTarget target, CancellationToken cancellationToken = default);
        Task<MultiServiceRemoteWriteTarget> SaveRemoteWithThreeServicesAsync(MultiServiceRemoteWriteTarget target, int priority, CancellationToken cancellationToken = default);
    }

    internal class MultiServiceRemoteWriteTargetFactory : FactorySaveBase<MultiServiceRemoteWriteTarget>, IFactorySave<MultiServiceRemoteWriteTarget>, IMultiServiceRemoteWriteTargetFactory
    {
        private readonly IServiceProvider ServiceProvider;
        private readonly IMakeRemoteDelegateRequest? MakeRemoteDelegateRequest;
        // Delegates
        public delegate Task<MultiServiceRemoteWriteTarget?> SaveRemoteWithTwoServicesDelegate(MultiServiceRemoteWriteTarget target, CancellationToken cancellationToken = default);
        public delegate Task<MultiServiceRemoteWriteTarget> SaveRemoteWithThreeServicesAsyncDelegate(MultiServiceRemoteWriteTarget target, int priority, CancellationToken cancellationToken = default);
        // Delegate Properties to provide Local or Remote fork in execution
        public SaveRemoteWithTwoServicesDelegate SaveRemoteWithTwoServicesProperty { get; }
        public SaveRemoteWithThreeServicesAsyncDelegate SaveRemoteWithThreeServicesAsyncProperty { get; }

        public MultiServiceRemoteWriteTargetFactory(IServiceProvider serviceProvider, IFactoryCore<MultiServiceRemoteWriteTarget> factoryCore) : base(factoryCore)
        {
            this.ServiceProvider = serviceProvider;
            SaveRemoteWithTwoServicesProperty = LocalSaveRemoteWithTwoServices;
            SaveRemoteWithThreeServicesAsyncProperty = LocalSaveRemoteWithThreeServicesAsync;
        }

        public MultiServiceRemoteWriteTargetFactory(IServiceProvider serviceProvider, IMakeRemoteDelegateRequest remoteMethodDelegate, IFactoryCore<MultiServiceRemoteWriteTarget> factoryCore) : base(factoryCore)
        {
            this.ServiceProvider = serviceProvider;
            this.MakeRemoteDelegateRequest = remoteMethodDelegate;
            SaveRemoteWithTwoServicesProperty = RemoteSaveRemoteWithTwoServices;
            SaveRemoteWithThreeServicesAsyncProperty = RemoteSaveRemoteWithThreeServicesAsync;
        }

        public virtual MultiServiceRemoteWriteTarget Create(CancellationToken cancellationToken = default)
        {
            return LocalCreate(cancellationToken);
        }

        public MultiServiceRemoteWriteTarget LocalCreate(CancellationToken cancellationToken = default)
        {
            return DoFactoryMethodCall(FactoryOperation.Create, () => new MultiServiceRemoteWriteTarget());
        }

        public Task<MultiServiceRemoteWriteTarget> LocalInsertRemoteWithTwoServices(MultiServiceRemoteWriteTarget target, CancellationToken cancellationToken = default)
        {
            var cTarget = (MultiServiceRemoteWriteTarget)target ?? throw new Exception("MultiServiceRemoteWriteTarget must implement MultiServiceRemoteWriteTarget");
            var service1 = ServiceProvider.GetRequiredService<IService>();
            var service2 = ServiceProvider.GetRequiredService<IService2>();
            return Task.FromResult(DoFactoryMethodCall(cTarget, FactoryOperation.Insert, () => cTarget.InsertRemoteWithTwoServices(service1, service2)));
        }

        public Task<MultiServiceRemoteWriteTarget> LocalUpdateRemoteWithTwoServices(MultiServiceRemoteWriteTarget target, CancellationToken cancellationToken = default)
        {
            var cTarget = (MultiServiceRemoteWriteTarget)target ?? throw new Exception("MultiServiceRemoteWriteTarget must implement MultiServiceRemoteWriteTarget");
            var service1 = ServiceProvider.GetRequiredService<IService>();
            var service2 = ServiceProvider.GetRequiredService<IService2>();
            return Task.FromResult(DoFactoryMethodCall(cTarget, FactoryOperation.Update, () => cTarget.UpdateRemoteWithTwoServices(service1, service2)));
        }

        public Task<MultiServiceRemoteWriteTarget> LocalDeleteRemoteWithTwoServices(MultiServiceRemoteWriteTarget target, CancellationToken cancellationToken = default)
        {
            var cTarget = (MultiServiceRemoteWriteTarget)target ?? throw new Exception("MultiServiceRemoteWriteTarget must implement MultiServiceRemoteWriteTarget");
            var service1 = ServiceProvider.GetRequiredService<IService>();
            var service2 = ServiceProvider.GetRequiredService<IService2>();
            return Task.FromResult(DoFactoryMethodCall(cTarget, FactoryOperation.Delete, () => cTarget.DeleteRemoteWithTwoServices(service1, service2)));
        }

        public Task<MultiServiceRemoteWriteTarget> LocalInsertRemoteWithThreeServicesAsync(MultiServiceRemoteWriteTarget target, int priority, CancellationToken cancellationToken = default)
        {
            var cTarget = (MultiServiceRemoteWriteTarget)target ?? throw new Exception("MultiServiceRemoteWriteTarget must implement MultiServiceRemoteWriteTarget");
            var service1 = ServiceProvider.GetRequiredService<IService>();
            var service2 = ServiceProvider.GetRequiredService<IService2>();
            var service3 = ServiceProvider.GetRequiredService<IService3>();
            return DoFactoryMethodCallAsync(cTarget, FactoryOperation.Insert, () => cTarget.InsertRemoteWithThreeServicesAsync(priority, service1, service2, service3));
        }

        public virtual Task<MultiServiceRemoteWriteTarget?> SaveRemoteWithTwoServices(MultiServiceRemoteWriteTarget target, CancellationToken cancellationToken = default)
        {
            return SaveRemoteWithTwoServicesProperty(target, cancellationToken);
        }

        public virtual async Task<MultiServiceRemoteWriteTarget?> RemoteSaveRemoteWithTwoServices(MultiServiceRemoteWriteTarget target, CancellationToken cancellationToken = default)
        {
            return (await MakeRemoteDelegateRequest!.ForDelegateNullable<MultiServiceRemoteWriteTarget?>(typeof(SaveRemoteWithTwoServicesDelegate), [target], cancellationToken))!;
        }

        public virtual Task<MultiServiceRemoteWriteTarget?> LocalSaveRemoteWithTwoServices(MultiServiceRemoteWriteTarget target, CancellationToken cancellationToken = default)
        {
            if (target.IsDeleted)
            {
                if (target.IsNew)
                {
                    return Task.FromResult(default(MultiServiceRemoteWriteTarget));
                }

                return (LocalDeleteRemoteWithTwoServices(target, cancellationToken))!;
            }
            else if (target.IsNew)
            {
                return (LocalInsertRemoteWithTwoServices(target, cancellationToken))!;
            }
            else
            {
                return (LocalUpdateRemoteWithTwoServices(target, cancellationToken))!;
            }
        }

        async Task<IFactorySaveMeta?> IFactorySave<MultiServiceRemoteWriteTarget>.Save(MultiServiceRemoteWriteTarget target, CancellationToken cancellationToken)
        {
            return (IFactorySaveMeta? )await SaveRemoteWithTwoServices(target, cancellationToken);
        }

        public virtual Task<MultiServiceRemoteWriteTarget> SaveRemoteWithThreeServicesAsync(MultiServiceRemoteWriteTarget target, int priority, CancellationToken cancellationToken = default)
        {
            return SaveRemoteWithThreeServicesAsyncProperty(target, priority, cancellationToken);
        }

        public virtual async Task<MultiServiceRemoteWriteTarget> RemoteSaveRemoteWithThreeServicesAsync(MultiServiceRemoteWriteTarget target, int priority, CancellationToken cancellationToken = default)
        {
            return (await MakeRemoteDelegateRequest!.ForDelegate<MultiServiceRemoteWriteTarget>(typeof(SaveRemoteWithThreeServicesAsyncDelegate), [target, priority], cancellationToken))!;
        }

        public virtual Task<MultiServiceRemoteWriteTarget> LocalSaveRemoteWithThreeServicesAsync(MultiServiceRemoteWriteTarget target, int priority, CancellationToken cancellationToken = default)
        {
            if (target.IsDeleted)
            {
                throw new NotImplementedException();
            }
            else if (target.IsNew)
            {
                return LocalInsertRemoteWithThreeServicesAsync(target, priority, cancellationToken);
            }
            else
            {
                throw new NotImplementedException();
            }
        }

        public static void FactoryServiceRegistrar(IServiceCollection services, NeatooFactory remoteLocal)
        {
            services.AddScoped<MultiServiceRemoteWriteTargetFactory>();
            services.AddScoped<IMultiServiceRemoteWriteTargetFactory, MultiServiceRemoteWriteTargetFactory>();
            services.AddScoped<IFactorySave<MultiServiceRemoteWriteTarget>, MultiServiceRemoteWriteTargetFactory>();
            // Register AOT-compatible ordinal converter
            global::Neatoo.RemoteFactory.Internal.NeatooOrdinalConverterFactory.RegisterConverter(MultiServiceRemoteWriteTarget.CreateOrdinalConverter());
            services.AddScoped<SaveRemoteWithTwoServicesDelegate>(cc =>
            {
                var factory = cc.GetRequiredService<MultiServiceRemoteWriteTargetFactory>();
                return (MultiServiceRemoteWriteTarget target, CancellationToken cancellationToken = default) => factory.LocalSaveRemoteWithTwoServices(target, cancellationToken);
            });
            services.AddScoped<SaveRemoteWithThreeServicesAsyncDelegate>(cc =>
            {
                var factory = cc.GetRequiredService<MultiServiceRemoteWriteTargetFactory>();
                return (MultiServiceRemoteWriteTarget target, int priority, CancellationToken cancellationToken = default) => factory.LocalSaveRemoteWithThreeServicesAsync(target, priority, cancellationToken);
            });
            // Event registrations
            if (remoteLocal == NeatooFactory.Remote)
            {
            }

            if (remoteLocal == NeatooFactory.Logical || remoteLocal == NeatooFactory.Server)
            {
            }
        }
    }
}