# NF0402: Event method must be in Factory class

## Description

Methods marked with `[Event]` must be declared in a class that also has the `[Factory]` attribute. The source generator needs the `[Factory]` attribute to generate the delegate type and DI registrations.

| Property | Value |
|----------|-------|
| **Diagnostic ID** | NF0402 |
| **Severity** | Error |
| **Category** | RemoteFactory.Usage |
| **Default** | Enabled |

## Example

The following code triggers NF0402:

```csharp
// Error NF0402: Missing [Factory] attribute
public partial class NotificationHandler
{
    [Event]
    public Task SendNotification(
        Guid userId,
        [Service] INotificationService notifications,
        CancellationToken ct)
    {
        return notifications.SendAsync(userId, ct);
    }
}
```

## How to Fix

Add the `[Factory]` attribute to the containing class:

```csharp
// Correct: Class has [Factory] attribute
[Factory]
public partial class NotificationHandler
{
    [Event]
    public Task SendNotification(
        Guid userId,
        [Service] INotificationService notifications,
        CancellationToken ct)
    {
        return notifications.SendAsync(userId, ct);
    }
}
```

For static classes:

```csharp
// Correct: Static class with [Factory] attribute
[Factory]
public static partial class NotificationHandler
{
    [Event]
    public static Task SendNotification(
        Guid userId,
        [Service] INotificationService notifications,
        CancellationToken ct)
    {
        return notifications.SendAsync(userId, ct);
    }
}
```

## Why This Matters

The `[Factory]` attribute triggers the source generator to process the class. Without it, the generator won't create:

- The delegate type (`SendNotificationEvent`)
- DI registrations for the delegate
- Remote calling infrastructure

## Related Diagnostics

- [NF0401](NF0401.md) - Event method must return void or Task
- [NF0404](NF0404.md) - Event method must have CancellationToken as final parameter
