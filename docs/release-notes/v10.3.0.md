---
layout: default
title: "v10.3.0"
description: "Release notes for Neatoo RemoteFactory v10.3.0"
parent: Release Notes
nav_order: 3
---

# v10.3.0 - Comprehensive Logging with CorrelationId

**Release Date:** 2026-01-03
**NuGet:** [Neatoo.RemoteFactory 10.3.0](https://nuget.org/packages/Neatoo.RemoteFactory/10.3.0)

## Overview

This release adds comprehensive, high-performance logging using .NET's `LoggerMessage` source generator pattern. All major operations are now logged with structured properties, timing information, and correlation IDs for distributed tracing.

## What's New

### Structured Logging

All RemoteFactory operations now emit structured log messages optimized for production use:

```csharp
// Example log output
[ca4fd87237a3] Factory operation Fetch started for Person
[ca4fd87237a3] Factory operation Fetch completed for Person in 12ms
```

### CorrelationId Support

Requests are automatically traced across client and server with a unique correlation ID:

```csharp
// Client-side
[a1b2c3d4e5f6] Remote delegate call started: PersonFactory+FetchByIdDelegate

// Server-side (same correlation ID)
[a1b2c3d4e5f6] Handling remote request for delegate PersonFactory+FetchByIdDelegate
[a1b2c3d4e5f6] Factory operation Fetch started for Person
[a1b2c3d4e5f6] Factory operation Fetch completed for Person in 12ms
[a1b2c3d4e5f6] Remote request completed for delegate PersonFactory+FetchByIdDelegate in 45ms
```

The correlation ID propagates automatically via:
- `CorrelationContext.CorrelationId` ambient property (AsyncLocal)
- `X-Correlation-Id` HTTP header for remote calls

### Event ID Ranges

Log messages are organized by subsystem with distinct event ID ranges:

| Range | Subsystem | Examples |
|-------|-----------|----------|
| 1xxx | Serialization | Serialize, Deserialize, Format selection |
| 2xxx | Factory Operations | Create, Fetch, Insert, Update, Delete |
| 3xxx | Remote Calls (Client) | HTTP request/response, errors |
| 4xxx | Converter Factory | Converter creation, cache hits |
| 5xxx | Authorization | Auth checks, grants, denials |
| 6xxx | Service Registration | DI registration events |
| 7xxx | Server-Side Handling | Request handling, completion |

### Logger Categories

Three logger categories for fine-grained log filtering:

| Category | Purpose |
|----------|---------|
| `Neatoo.RemoteFactory.Internal.FactoryCore` | Factory operation lifecycle |
| `Neatoo.RemoteFactory.Internal.NeatooJsonSerializer` | Serialization events |
| `Neatoo.RemoteFactory.Server` | Server-side request handling |

### NeatooLogging Static Class

Configure logging for static/ambient contexts:

```csharp
// In application startup (after DI container is built)
NeatooLogging.SetLoggerFactory(app.Services.GetRequiredService<ILoggerFactory>());
```

### Recommended Log Levels

| Environment | Recommended Level |
|-------------|------------------|
| Production | Information |
| Development | Debug |
| Troubleshooting | Trace |

Configure in `appsettings.json`:

```json
{
  "Logging": {
    "LogLevel": {
      "Default": "Warning",
      "Neatoo.RemoteFactory": "Information"
    }
  }
}
```

## New Files

| File | Purpose |
|------|---------|
| `Internal/Log.cs` | LoggerMessage definitions |
| `Internal/NeatooLogging.cs` | Ambient logger factory |
| `Internal/NeatooLoggerCategories.cs` | Category constants |
| `Internal/CorrelationContext.cs` | CorrelationId propagation |

## Breaking Changes

None. Logging is opt-in and does not affect existing behavior.

## Bug Fixes

None.

## Migration Guide

No migration required. Logging is automatically available when `Microsoft.Extensions.Logging` is configured in your application.

To enable logging:

```csharp
// Program.cs
builder.Services.AddLogging(logging =>
{
    logging.AddConsole();
    logging.SetMinimumLevel(LogLevel.Information);
});

// After building the app
var app = builder.Build();
NeatooLogging.SetLoggerFactory(app.Services.GetRequiredService<ILoggerFactory>());
```

## Commits

- feat: Add comprehensive logging with LoggerMessage source generator
- feat: Add CorrelationId support for distributed tracing
- feat: Add logging to serialization, factory operations, and server handling
- docs: Add logging documentation and event reference
